---
layout: post
title: "Spring Cloud"
date: 2025-06-21 22:00:00 +0900
categories: msa
background: '/img/posts/10.jpg'
---

# 2. Spring Cloud


💡마이크로서비스 아키텍처를 구축하고 운영하는 데 필요한 다양한 기능을 제공하는 Spring Framework의 확장 모음이다. Spring Cloud는 여러 개별 서비스가 서로 원활하게 통신하고 관리될 수 있도록 돕는 도구와 패턴을 제공한다.



## 2-1. Eureka


💡Netflix가 개발한 서비스 등록 및 발견 서버로 각 서비스는 Eureka 서버에 자신의 정보를 등록하고, 다른 서비스는 이를 통해 필요한 서비스를 찾아 호출할 수 있다. 클라이언트 측 로드 밸런싱과 장애 감지 기능을 제공한다.





### 2-1-1. 클라이언트 요청과 API Gateway

- 클라이언트(Client)가 서비스를 호출할 때, 직접 개별 서비스에 접근하지 않고 API Gateway를 통해 요청을 보낸다.
- API Gateway는 마이크로서비스 아키텍처에서 단일 진입점(Single Entry Point) 역할을 한다.
- 클라이언트는 각기 다른 마이크로 서비스에 직접 접근하지 않고, 통합된 인터페이스를 통해 서비스를 요청할 수 있다.
- API Gateway는 요청을 라우팅하고, 각기 다른 서비스로 분배하는 역할을 하며, 인증, 권한 부여, 로깅 등의 공통적인 기능도 수행할 수 있다.

### 2-1-2. Service Discovery

- Eureka는 Service Discovery를 담당하는 구성 요소로, 마이크로서비스가 동적으로 변화할 수 있는 환경에서 서비스들의 위치를 추적하고 관리한다.
- Eureka Server: 각 서비스 인스턴스들이 자신의 상태와 위치를 등록하는 중앙 관리 시스템이다.
- Eureka Client: Service Instance A, B, C는 Eureka Client로 동작한다. 각 인스턴스는 시작 시 Eureka 서버에 자신을 등록하고, 주기적으로 상태를 Health Check하며, 그 결과를 서버에 업데이트 한다. 이를 통해 Eureka 서버는 현재 실행 중인 서비스의 위치와 상태를 실시간으로 파악한다.
- 새로운 서비스 인스턴스가 생성되거나 기존 인스턴스가 종료되면, Eureka 서버는 이러한 변화를 실시간으로 반영하여, API Gateway와 Load Balancer가 올바른 서비스로 요청을 전달할 수 있게 돕는다.

### 2-1-3. Load Balancer

- 로드 밸런서(Load Balancer)는 서비스 간의 트래픽 분산을 담당한다.
- 클라이언트가 API Gateway를 통해 요청을 보내면, 그 요청은 서비스 인스턴스 중 하나로 전달되어야 한다. 이때, 로드 밸런서가 Eureka 서버에서 받은 서비스 인스턴스 정보를 바탕으로, 요청을 적절한 인스턴스로 분배한다.
- 로드 밸런서는 각 인스턴스의 상태(Health Status)를 주기적으로 체크하여, 문제가 있는 인스턴스에는 트래픽을 보내지 않도록 하여 시스템의 안정성을 높인다.
- 또한, 부하가 특정 인스턴스에 치우치지 않도록 부하 분산 기능을 수행하여 전체 시스템의 성능을 최적화한다.

### 2-1-4. Service Instances

- 서비스 인스턴스 A, B, C는 각기 다른 포트에서 구동되고 있으며, 실제 비즈니스 로직을 수행하는 역할을 한다.
- 각 인스턴스는 고유의 포트 번호로 구동되며, 클라이언트의 요청에 따라 API Gateway와 Load Balancer를 통해 서비스 된다.
- 마이크로서비스 환경에서는 이런 인스턴스들이 필요에 따라 확장되거나 축소될 수 있다. 예를 들어, 트래픽이 증가하면 더 많은 인스턴스를 추가하여 처리 능력을 높일 수 있다.

### 2-1-5. 전체적인 흐름

- 클라이언트가 특정 서비스를 요청하면, 요청은 API Gateway로 전달된다.
- API Gateway는 요청된 서비스의 이름을 기반으로 Eureka 서버에서 해당 서비스의 인스턴스 정보를 조회한다.
- 조회된 정보는 로드 밸런서에 전달되고, 로드 밸런서는 각 서비스의 상태를 확인한 후, 적절한 서비스 인스턴스로 요청을 전달한다.
- 서비스 인스턴스는 요청을 처리하고 그 결과를 API Gateway를 통해 클라이언트에게 반환한다.