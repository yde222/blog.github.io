<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Vagrant를 이용한 환경구축 - Clean Blog
    
  </title>

  <meta name="description" content="Vagrant란?">

  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/startbootstrap-clean-blog-jekyll/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/startbootstrap-clean-blog-jekyll/ansible/2025/06/21/Vagrant%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%9C_%ED%99%98%EA%B2%BD%EA%B5%AC%EC%B6%95.html">
  <link rel="alternate" type="application/rss+xml" title="Clean Blog" href="/startbootstrap-clean-blog-jekyll/feed.xml">

</head>


<body>

  <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/startbootstrap-clean-blog-jekyll/">Clean Blog</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="/startbootstrap-clean-blog-jekyll/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/startbootstrap-clean-blog-jekyll/about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/startbootstrap-clean-blog-jekyll/posts">Posts</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/startbootstrap-clean-blog-jekyll/categories">Category</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/startbootstrap-clean-blog-jekyll/contact">Contact</a>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->

<header class="masthead" style="background-image: url('/startbootstrap-clean-blog-jekyll/img/posts/09.jpg')">
  
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Vagrant를 이용한 환경구축</h1>
            
            <span class="meta">Posted by
              <a href="#">Start Bootstrap</a>
              on June 21, 2025 &middot; <span class="reading-time" title="Estimated read time">
  
   6 mins  read </span>

            </span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">

        <h2 id="vagrant란">Vagrant란?</h2>

<p><strong>Vagrant</strong>는 개발 환경을 코드로 정의하고 손쉽게 복제할 수 있도록 도와주는 <strong>가상 머신 자동화 관리 도구</strong>입니다. VirtualBox, VMware, Hyper-V 같은 가상화 소프트웨어 위에 작동하며, 가상 머신의 생성, 설정, 부팅, 폐기를 한 줄의 명령어로 제어할 수 있게 해줍니다.</p>

<hr />

<h2 id="vagrant-vs-virtualbox">Vagrant vs VirtualBox</h2>

<table>
  <thead>
    <tr>
      <th>항목</th>
      <th>Vagrant</th>
      <th>VirtualBox</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>목적</td>
      <td>VM 자동화 관리 도구</td>
      <td>가상화 실행 엔진 (하이퍼바이저)</td>
    </tr>
    <tr>
      <td>기능</td>
      <td>VM 생성, 설정, 부팅 자동화</td>
      <td>수동 GUI 기반 가상 머신 설정 및 실행</td>
    </tr>
    <tr>
      <td>설정 방식</td>
      <td>코드 기반 (Vagrantfile)</td>
      <td>GUI 클릭 기반</td>
    </tr>
    <tr>
      <td>반복성</td>
      <td>동일한 환경을 코드로 재현 가능</td>
      <td>동일한 환경 구성 복제 어려움</td>
    </tr>
    <tr>
      <td>실습 활용</td>
      <td>DevOps, 인프라 자동화 실습에 적합</td>
      <td>단일 테스트나 GUI 실습에 적합</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="1-요구-사항">1. 요구 사항</h2>

<h3 id="호스트-시스템">호스트 시스템</h3>

<ul>
  <li>운영체제: Windows 10 이상</li>
  <li>설치 필요:
    <ul>
      <li><a href="https://www.virtualbox.org/">VirtualBox</a></li>
      <li>Vagrant</li>
      <li>텍스트 에디터 (VSCode, Notepad++ 등)</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="2-실습용-디렉토리-준비">2. 실습용 디렉토리 준비</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Windows PowerShell 또는 CMD에서
mkdir C:\\vagrant\\ansible-lab
cd C:\\vagrant\\ansible-lab
vagrant init

</code></pre></div></div>

<hr />

<h2 id="3-vagrantfile-설정">3. Vagrantfile 설정</h2>

<p><code class="language-plaintext highlighter-rouge">Vagrantfile</code>을 다음과 같이 수정합니다:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Vagrant.configure("2") do |config|
  config.vm.define "ansible-master" do |master|
    master.vm.box = "ubuntu/jammy64"
    master.vm.hostname = "ansible-master"
    master.vm.network "private_network", ip: "192.168.56.10"
  end

  config.vm.define "node1" do |node|
    node.vm.box = "ubuntu/jammy64"
    node.vm.hostname = "node1"
    node.vm.network "private_network", ip: "192.168.56.11"
  end

  config.vm.define "node2" do |node|
    node.vm.box = "ubuntu/jammy64"
    node.vm.hostname = "node2"
    node.vm.network "private_network", ip: "192.168.56.12"
  end
end

</code></pre></div></div>

<hr />

<blockquote>
  <p>ubuntu/jammy64는 Ubuntu 22.04 LTS 입니다.</p>
</blockquote>

<h2 id="4-vm-부팅-및-접속">4. VM 부팅 및 접속</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vagrant up
vagrant ssh ansible-master

</code></pre></div></div>

<hr />

<h2 id="5-ansible-master-서버-설정">5. Ansible Master 서버 설정</h2>

<h3 id="1-ansible-설치">(1) Ansible 설치</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt update
sudo apt install -y ansible

</code></pre></div></div>

<h3 id="2-ssh-키-설정-및-복사">(2) SSH 키 설정 및 복사</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ansible-master에서
ssh-keygen -t rsa -N "" -f ~/.ssh/id_rsa

# node1/node2에 복사
ssh-copy-id vagrant@192.168.56.11
ssh-copy-id vagrant@192.168.56.12

</code></pre></div></div>

<blockquote>
  <p>처음 접속 시 “Are you sure you want to continue connecting?” 메시지에 yes 입력</p>
</blockquote>

<h3 id="3-인벤토리-설정">(3) 인벤토리 설정</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo mkdir -p /etc/ansible
sudo vi /etc/ansible/hosts

</code></pre></div></div>

<p>내용:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[targets]
node1 ansible_host=192.168.56.11 ansible_user=vagrant ansible_ssh_private_key_file=/home/vagrant/.ssh/node1_key
node2 ansible_host=192.168.56.12 ansible_user=vagrant ansible_ssh_private_key_file=/home/vagrant/.ssh/node2_key

</code></pre></div></div>

<blockquote>
  <p>SSH 키는 공유폴더(/vagrant/…)에서 복사해와야 함:</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp /vagrant/.vagrant/machines/node1/virtualbox/private_key ~/.ssh/node1_key
cp /vagrant/.vagrant/machines/node2/virtualbox/private_key ~/.ssh/node2_key
chmod 600 ~/.ssh/node1_key ~/.ssh/node2_key

</code></pre></div></div>

<h3 id="4-ssh-config-설정-선택">(4) SSH config 설정 (선택)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi ~/.ssh/config

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host node1
  HostName 192.168.56.11
  User vagrant
  IdentityFile ~/.ssh/node1_key

Host node2
  HostName 192.168.56.12
  User vagrant
  IdentityFile ~/.ssh/node2_key

</code></pre></div></div>

<hr />

<h2 id="6-ansible-테스트">6. Ansible 테스트</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m ping

</code></pre></div></div>

<p>예상 출력:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node1 | SUCCESS =&gt; {"ping": "pong"}
node2 | SUCCESS =&gt; {"ping": "pong"}

</code></pre></div></div>

<hr />

<h2 id="7-참고">7. [참고]</h2>

<ul>
  <li>Vagrant 공유 폴더에서는 <code class="language-plaintext highlighter-rouge">chmod</code>가 정상 동작하지 않음 → 개인 키는 반드시 <code class="language-plaintext highlighter-rouge">~/.ssh/</code>로 복사 후 <code class="language-plaintext highlighter-rouge">chmod 600</code></li>
  <li>Ansible은 <code class="language-plaintext highlighter-rouge">~/.ssh/config</code>를 사용할 수도 있지만, 가장 안정적인 방법은 인벤토리 파일에서 <code class="language-plaintext highlighter-rouge">ansible_ssh_private_key_file</code>을 직접 지정하는 것</li>
</ul>

<hr />

<h2 id="8-ad-hoc-명령어란">8. Ad-Hoc 명령어란?</h2>

<p>Ansible에서 <strong>ad-hoc 명령어</strong>는 플레이북을 작성하지 않고 단일 작업을 단발성으로 실행할 수 있는 명령어입니다. 주로 테스트, 시스템 점검, 단순 작업을 빠르게 실행할 때 유용합니다.</p>

<h3 id="어디에서-실행해야-하나요">어디에서 실행해야 하나요?</h3>

<p>Ad-hoc 명령어는 <strong>Ansible이 설치된 제어 노드(여기서는 ansible-master)</strong>에서 실행해야 합니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vagrant ssh ansible-master

</code></pre></div></div>

<p>접속 후, 다음과 같은 형식으로 명령을 실행합니다:</p>

<h3 id="형식">형식</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible [대상] -m [모듈] -a "[인자]"

</code></pre></div></div>

<h3 id="주요-예시와-설명">주요 예시와 설명</h3>

<h3 id="1-ping-테스트">(1) ping 테스트</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m ping

</code></pre></div></div>

<p><strong>설명:</strong> 대상 서버가 Ansible을 통해 접속 가능한지 확인하는 기본 테스트입니다.</p>

<p><strong>결과:</strong> <code class="language-plaintext highlighter-rouge">SUCCESS</code>와 함께 <code class="language-plaintext highlighter-rouge">{"ping": "pong"}</code> 출력</p>

<h3 id="2-원격-명령-실행">(2) 원격 명령 실행</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m command -a "uptime"

</code></pre></div></div>

<p><strong>설명:</strong> 각 노드의 시스템 부하 상태(uptime)를 확인합니다.</p>

<p><strong>결과:</strong> 시스템 부팅 이후 경과 시간, 로그인 사용자 수, 평균 부하율 출력</p>

<h3 id="3-패키지-설치">(3) 패키지 설치</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m apt -a "name=tree state=present update_cache=yes" --become

</code></pre></div></div>

<p><strong>설명:</strong> <code class="language-plaintext highlighter-rouge">tree</code>라는 패키지를 모든 노드에 설치합니다.</p>

<p><strong>결과:</strong> 설치 성공 여부와 변경 상태 (<code class="language-plaintext highlighter-rouge">changed</code>: true/false)</p>

<h3 id="4-서비스-상태-확인-및-시작">(4) 서비스 상태 확인 및 시작</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m service -a "name=nginx state=started enabled=yes" --become

</code></pre></div></div>

<p><strong>설명:</strong> nginx 서비스를 시작하고 부팅 시 자동 실행되도록 설정합니다.</p>

<p><strong>결과:</strong> <code class="language-plaintext highlighter-rouge">state=started</code>와 <code class="language-plaintext highlighter-rouge">enabled=true</code> 여부에 따른 결과 출력</p>

<h3 id="5-파일-복사">(5) 파일 복사</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m copy -a "src=/etc/hosts dest=/tmp/hosts_copy" --become

</code></pre></div></div>

<p><strong>설명:</strong> 제어 노드의 <code class="language-plaintext highlighter-rouge">/etc/hosts</code> 파일을 대상 서버의 <code class="language-plaintext highlighter-rouge">/tmp/hosts_copy</code>로 복사합니다.</p>

<p><strong>결과:</strong> 파일이 복사되었는지 여부 (<code class="language-plaintext highlighter-rouge">changed</code>: true)</p>

<h3 id="6-사용자-추가">(6) 사용자 추가</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m user -a "name=devuser shell=/bin/bash" --become

</code></pre></div></div>

<p><strong>설명:</strong> 각 노드에 <code class="language-plaintext highlighter-rouge">devuser</code>라는 사용자 계정을 추가합니다.</p>

<p><strong>결과:</strong> 사용자가 생성되었는지 여부 출력</p>

<p><strong>확인 방법:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible targets -m command -a "id devuser"

</code></pre></div></div>

<p><strong>예상 결과:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node1 | SUCCESS =&gt; {"stdout": "uid=1001(devuser) gid=1001(devuser) groups=1001(devuser)"}
node2 | SUCCESS =&gt; {"stdout": "uid=1001(devuser) gid=1001(devuser) groups=1001(devuser)"}

</code></pre></div></div>

<blockquote>
  <p>–become은 root 권한이 필요한 작업에서 사용합니다.</p>
</blockquote>

<hr />



        <hr>

        <div class="clearfix">

          
          <a class="btn btn-primary float-left" href="/startbootstrap-clean-blog-jekyll/ansible/2025/06/21/MySQL_%EC%84%A4%EC%B9%98_%EC%8B%A4%EC%8A%B5.html" data-toggle="tooltip" data-placement="top" title="MySQL 설치 실습">&larr; Previous<span class="d-none d-md-inline">
              Post</span></a>
          
          
          <a class="btn btn-primary float-right" href="/startbootstrap-clean-blog-jekyll/ansible/2025/06/21/ansible_is.html" data-toggle="tooltip" data-placement="top" title="Ansible이란">Next<span class="d-none d-md-inline">
              Post</span> &rarr;</a>
          

        </div>

      </div>
    </div>
  </div>


  <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:your-email@example.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://twitter.com/SBootstrap">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.facebook.com/StartBootstrap">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/StartBootstrap">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; Start Bootstrap 2025</p>
      </div>
    </div>
  </div>
</footer>


  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/startbootstrap-clean-blog-jekyll/assets/vendor/startbootstrap-clean-blog/js/scripts.js"></script>

<script src="/startbootstrap-clean-blog-jekyll/assets/scripts.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-XXXXXXXXX-X');
</script>



</body>

</html>
